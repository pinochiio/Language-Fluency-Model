<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <link rel="stylesheet" href="style_c.css">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <!-- awesome text -->
    <script src="https://kit.fontawesome.com/5be4b20584.js" crossorigin="anonymous"></script>

    <!-- google fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Candal&family=Lora:ital,wght@0,400..700;1,400..700&display=swap" rel="stylesheet">
    <!-- custom styling -->
    <style>
        *{
    box-sizing: border-box;
}
body{
    padding: 0px;
    margin: 0px;
    background: #f6f6f6;
    font-family: 'Lora',serif;
    background-image: url('https://img.freepik.com/free-vector/abstract-watercolor-background-concept_23-2148825784.jpg?w=900&t=st=1709925202~exp=1709925802~hmac=830010adafc0343a24aa4724ae1a5d521ff28b798e4744cffc79ef121a0bcecc'); 
}
header{
    background-color: #008489;
    height: 66px;
}
header *{
    color:white;
}
header .logo{
    float: left;
    height: inherit;
    margin-left:2em;
}
header.logo-text{
    margin: 8px;
    font-family: 'Candal', serif;
}
header .logo-text span{
    color: #b0e0e6;
}
header ul{
    float: right;
    margin: 0px;
    padding: 0px;
    list-style: none;
}
header ul li{
    float: left;
    position: relative;
}
header ul li ul{
    position: absolute;
    top: 66 px;
    right: 0px;
    width: 130px;
    display: none;
}
header ul li:hover ul{
    display: block;
}
header ul li ul li{
    width: 100%;
}
header ul li ul li a{
    padding: 10px;
    background: white;
    color: #444;
}
header ul li ul li a.logout{
    color: red;
}
header ul li ul li a:hover{
    background: #d5d6d6;
}
header ul li a{
    display: block;
    padding: 21px;
    font-size: 1.1em;
    text-decoration: none;
}
header ul li a:hover{
    background:#006669;
    transition: 0.5s;
}
header .menu-toggle{
    display: none;
}
input[type="submit"] {
    padding: 5px; /* Add padding to the submit button */
}
.centered-textbox {
    display: flex;
    flex-direction: column;
    align-items: center; /* This centers the flex items (children) on the cross axis (horizontally for column direction) */
    justify-content: center;
    gap: 10px; /* Adds space between each item */
    height: calc(100vh - 70px);
    height: calc(100vh - 70px); /* Adjusted height to be centered within the header */
}

#tx {
    width: 75%;
    margin-bottom: 5px; /* Add margin for spacing */
}
#bt{
    padding: 7px 20px; /* Increase padding for a larger button */
    font-size: 12px; /* Increase font size for larger text */
    margin-top: 10px; /* Add some space above the button */
    cursor: pointer; /* Changes the cursor on hover to indicate it's clickable */
    border: none; /* Removes the default border */
    border-radius: 5px; /* Optional: Adds rounded corners to the button */
    background-color: #008489; /* Button color */
    color: white; /* Text color */
    transition: background-color 0.3s;
}
#twisterContainer {
    width: 600px; /* Set a fixed width */
    height: 150px; /* Set a fixed height */
    border: 2px solid #008489; /* Added border */
    border-radius: 5px; /* Rounded corners */
    padding: 10px; /* Internal spacing */
    resize: none; /* Disables resizing */
    margin-bottom: 5px; 
    width: 75%;
    margin-bottom: 5px;
}
#tx2 {
    width: 600px; /* Set a fixed width */
    height: 150px; /* Set a fixed height */
    border: 2px solid #008489; /* Added border */
    border-radius: 5px; /* Rounded corners */
    padding: 10px; /* Internal spacing */
    resize: none; /* Disables resizing */
    margin-bottom: 5px; 
    width: 75%;
    margin-bottom: 5px;
}
.textarea-container {
    display: flex;
    align-items: center; /* Keep items vertically aligned */
    justify-content: space-between; /* Adjust this as necessary */
}

.mic-button {
    display: block; /* Make the button a block-level element to take up its own line */
    margin: 10px auto; /* Center the button horizontally */
    padding: 5px 10px; /* Adjust padding as necessary */
    font-size: 16px; /* Adjust size as necessary */
    cursor: pointer;
    background-color: #008489; /* Example button color */
    color: white; /* Example text color */
    border: none;
    border-radius: 5px;
}

/* Ensure the button icon size is appropriate */
.mic-button i {
    font-size: 24px; /* Adjust the icon size as necessary */
}

.textarea-with-label {
    display: flex; /* This makes the label and the textarea align horizontally */
    align-items: center; /* This centers them vertically relative to each other */
    gap: 10px; /* Adds some space between the label and the textarea */
    margin-bottom: 5px; /* Ensures some space below the wrapped elements before the microphone button */
}

.textarea-label {
    white-space: nowrap; /* Prevents the label from wrapping */
    margin-right: 10px; /* Optional: adds some space between the label and the textarea */
}
#id{
    display: flex; /* This makes the label and the textarea align horizontally */
    align-items: center; /* This centers them vertically relative to each other */
    gap: 10px; /* Adds some space between the label and the textarea */
    margin-bottom: 5px; 
    white-space: nowrap; /* Prevents the label from wrapping */
    margin-right: 10px;
}

.centered-textbox {
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    gap: 10px;
    margin-top: 20px; /* Adjust this value as needed to create space below the navbar */
}

.textarea-with-label {
    display: flex;
    align-items: center;
    gap: 10px;
    width: 100%; /* Ensure the container takes up full width */
    justify-content: center; /* Center the content */
}

.textarea-label {
    white-space: nowrap;
    margin-right: 10px;
}

textarea {
    width: 600px; /* Or any fixed value to keep the size consistent */
    height: 150px;
    border: 2px solid #008489;
    border-radius: 5px;
    padding: 10px;
    resize: none;
}

.mic-button {
    padding: 10px;
    margin: 10px auto;
    background-color: #008489;
    color: white;
    border: none;
    border-radius: 5px;
    cursor: pointer;
}

/* Additional styles remain unchanged */


    </style>
    <title>Fluentify</title>
</head>
<body>
    <header>
        <div class="container">
            <div class="logo">
                <h1 class="logo-text"><span>Fluent</span>ify</h1>
            </div>
            <ul class="nav">
                <li><a href="index_c.html">Home</a></li>
                <li><a href="search.html">Text</a></li>
                <li><a href="twisters_c.html">Practice</a></li>
                <li><a href="blog.html">Blog</a></li>
                <li><a href="/logout" class="logout">Logout</a></li>
                
            </ul>  
        </div>
    </header>
   
        <div class="centered-textbox">
            <div class="textarea-with-label">
                <label for="twisterContainer" class="textarea-label"><b>Message to be Spoken:</b></label>
                <div id="twisterContainer" name="tx1" rows="10" cols="60">The sun dipped below the horizon, casting hues of orange and pink across the sky. A gentle breeze rustled the leaves, creating a soothing melody. As the stars began to twinkle overhead, the world embraced the tranquility of the night. Each moment held a whisper of possibility, and the air was filled with the promise of a new day.</div>
            </div>
            <button class="mic-button" id="mic-button" aria-label="Dictate" onclick="voice()" ><i class="fas fa-microphone"></i></button>
            <div id="output"></div>
            <div class="textarea-with-label">
                <label for="tx2" class="textarea-label"><b>Final Transcripted Text:</b></label>
                <div id="tx2" name="tx2" rows="10" cols="60"></div>
            </div>
            <form action="{{url_for('index_c')}}" method ="post">
                <input type="submit" id="bt"  value="Submit"></button>
            </form>
        </div>
   
    
    <script>
          document.getElementById("bt").addEventListener("click", function() {
            var twisterContent = document.getElementById("twisterContainer").textContent;
            var tx2Content = document.getElementById("tx2").textContent;

            var xhr = new XMLHttpRequest();
            xhr.open("POST", "/calculate_accuracy", true);
            xhr.setRequestHeader("Content-Type", "application/json");
            xhr.onreadystatechange = function () {
                if (xhr.readyState === 4 && xhr.status === 200) {
                    var response= JSON.parse(xhr.responseText);
                    alert("Accuracy calculated successfully!");
                    window.location.href = "/fluency?accuracy=" +response.accuracy;
                }
            };
            var data = JSON.stringify({ "twisterContent": twisterContent, "tx2Content": tx2Content });
            xhr.send(data);
        });

       if ('webkitSpeechRecognition' in window) {
            var recognition = new webkitSpeechRecognition();

            // Set the recognition language
            recognition.lang = 'en-US';

            // Set recognition parameters
            recognition.continuous = true;
            recognition.interimResults = true;

            // Event listener for when the recognition starts
            recognition.onstart = function() {
                document.getElementById('output').innerHTML = 'Listening...';
            };

            // Event listener for when the recognition ends
            recognition.onend = function() {
                document.getElementById('output').innerHTML += '<br>Recognition stopped.';
            };

            // Event listener for when the recognition results are ready
            recognition.onresult = function(event) {
                var interimTranscript = '';
                var finalTranscript = '';

                // Loop through the results
                for (var i = event.resultIndex; i < event.results.length; ++i) {
                    if (event.results[i].isFinal) {
                        finalTranscript += event.results[i][0].transcript;
                    } else {
                        interimTranscript += event.results[i][0].transcript;
                    }
                }

                // Output the final and interim transcripts
                document.getElementById('tx2').innerHTML += finalTranscript;
            };

            // Event listener for the startButton click
            document.getElementById('mic-button').addEventListener('click', function() {
                if (recognition && recognition.state === 'listening') {
                    recognition.stop();
                    document.getElementById('output').innerHTML += '<br>Recognition stopped manually.';
                } else {
                    recognition.start();
                }
            });
        } else {
            document.getElementById('output').innerHTML = 'Speech recognition not supported by your browser.';
        }
        window.onload = function() {
            var selectedTwister = localStorage.getItem('selectedTwister');
            if (selectedTwister) {
                document.getElementById('twisterContainer').innerText = selectedTwister;
                localStorage.removeItem('selectedTwister');
            }
        };
        
    </script>
</body>
</html> 
